<!DOCTYPE html>
<html lang="pt-BR" class=""> 
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulário de Integração com Chatwoot</title>
    <!-- Favicon -->
    <link rel="icon" href="https://pub-8f52d204ed064db89ad14d557601b5a0.r2.dev/favicon.ico" type="image/x-icon">
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Font Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            darkMode: 'class', 
            theme: {
                extend: {
                    colors: {
                        primary: '#2563eb', 
                        secondary: '#10b981', 
                        dark: '#1e293b',    
                        light: '#f8fafc',   
                        gray: {
                           ...tailwind.colors.gray, 
                           600: '#4b5563', 
                           700: '#374151', 
                           800: '#1f2937', 
                           900: '#111827'  
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'], 
                    },
                    ringColor: { 
                       DEFAULT: '#2563eb',
                       primary: '#2563eb',
                    },
                }
            }
        }
    </script>

    <!-- Script Dark Mode -->
    <script>
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
          document.documentElement.classList.add('dark')
        } else {
          document.documentElement.classList.remove('dark')
        }
    </script>

</head>
<body class="font-sans bg-light dark:bg-dark text-dark dark:text-light antialiased">

    <!-- Container com padding (removido max-width e mx-auto, padding pode ser ajustado p-4 ou p-2 se necessário) -->
    <div class="p-4"> 

        <!-- Título (pode diminuir o mb-6 para mb-4 se precisar de mais espaço vertical) -->
        <h1 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">Formulário de Integração</h1>

        <form id="contact-form" class="space-y-4">

            <!-- Campo Nome -->
            <div>
                <label for="name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nome</label>
                <input 
                    type="text" 
                    id="name" 
                    name="name" 
                    required 
                    placeholder="Nome completo" 
                    class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm 
                           bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100
                           placeholder-gray-400 dark:placeholder-gray-500
                           focus:ring-primary focus:border-primary focus:ring-1 
                           transition duration-150 ease-in-out text-sm"> 
            </div>

            <!-- Campo Email -->
            <div>
                <label for="email" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Email</label>
                <input 
                    type="email" 
                    id="email" 
                    name="email" 
                    required 
                    placeholder="seu@email.com" 
                    class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm
                           bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100
                           placeholder-gray-400 dark:placeholder-gray-500
                           focus:ring-primary focus:border-primary focus:ring-1 
                           transition duration-150 ease-in-out text-sm"> 
            </div>

            <!-- Campo Telefone -->
            <div>
                <label for="phone" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Telefone</label>
                <input 
                    type="tel" 
                    id="phone" 
                    name="phone" 
                    placeholder="(XX) XXXXX-XXXX" 
                    class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm
                           bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100
                           placeholder-gray-400 dark:placeholder-gray-500
                           focus:ring-primary focus:border-primary focus:ring-1 
                           transition duration-150 ease-in-out text-sm"> 
            </div>

            <!-- Campo Mensagem -->
            <div>
                <label for="message" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Mensagem</label>
                <textarea 
                    id="message" 
                    name="message" 
                    placeholder="Digite sua mensagem aqui..." 
                    rows="4" 
                    class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm
                           bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100
                           placeholder-gray-400 dark:placeholder-gray-500
                           focus:ring-primary focus:border-primary focus:ring-1 
                           transition duration-150 ease-in-out text-sm"></textarea> 
            </div>

            <!-- Botão Enviar -->
            <button 
                type="submit" 
                class="w-full bg-primary text-white font-bold py-2 px-4 rounded-md 
                       hover:bg-opacity-90 dark:hover:bg-opacity-80 
                       focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary 
                       dark:focus:ring-offset-dark transition duration-300 ease-in-out text-sm"> 
                Enviar
            </button>
        </form>
    </div>

    <!-- Modal -->
    <div id="success-modal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden">
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg">
            <h2 class="text-lg font-bold mb-4 text-gray-900 dark:text-white">Sucesso!</h2>
            <p class="text-gray-700 dark:text-gray-300 mb-4">Dados enviados com sucesso!</p>
            <button id="close-modal" class="bg-primary text-white font-bold py-2 px-4 rounded-md hover:bg-opacity-90 dark:hover:bg-opacity-80 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-offset-dark transition duration-300 ease-in-out text-sm">
                Fechar
            </button>
        </div>
    </div>

    <!-- SEU SCRIPT EXISTENTE (Chatwoot + N8N) -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ... existing code ...

            const contactForm = document.getElementById('contact-form');
            const webhookUrl = 'https://workflows.dubcom.com.br/webhook/3f858fbf-abf0-44a3-903b-ce27ca28de5d';
            const successModal = document.getElementById('success-modal');
            const closeModalButton = document.getElementById('close-modal');

            if (contactForm) {
                contactForm.addEventListener('submit', function(event) {
                    event.preventDefault(); 
                    const name = document.getElementById('name').value;
                    const email = document.getElementById('email').value;
                    const phone = document.getElementById('phone').value;
                    const message = document.getElementById('message').value;
                    const formData = { name, email, phone, message };
                    console.log('Enviando os seguintes dados para o n8n:', formData); 

                    fetch(webhookUrl, {
                        method: 'POST', 
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(formData), 
                    })
                    .then(response => {
                        if (!response.ok) {
                            return response.text().then(text => { throw new Error(`Erro Webhook: ${response.status} - ${text}`); });
                        }
                        return response.json().catch(() => ({ success: true, status: response.status }));
                    })
                    .then(data => {
                        console.log('Sucesso! Resposta n8n:', data);
                        successModal.classList.remove('hidden'); // Show the modal
                        contactForm.reset(); // Clear the form fields
                    })
                    .catch((error) => {
                        console.error('Erro ao enviar dados para n8n:', error);
                        alert(`Erro ao enviar: ${error.message}`); 
                    });
                });
            } else {
                console.error("Elemento do formulário com ID 'contact-form' não encontrado!");
            }

            // Close modal button event
            if (closeModalButton) {
                closeModalButton.addEventListener('click', function() {
                    successModal.classList.add('hidden'); // Hide the modal
                });
            }
            // ... existing code ...
        });
    </script>

</body>
</html>